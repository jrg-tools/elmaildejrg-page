---
import { Archive } from '@/components/Archive';
import Layout from '@/layouts/Layout.astro';
import { api } from '@/lib/api';
import type { Newsletter } from '@/lib/types';

const { slug } = Astro.params;
if (!slug) {
  return new Response(null, { status: 404 });
}

let {
  id,
  content,
  blocks,
  isPublished,
  updatedAt,
  createdAt,
}: Partial<Newsletter> = {};

try {
  const res: Newsletter = await api.get(`/newsletter/${slug}`);

  id = res.id;
  content = res.content;
  blocks = res.blocks;
  isPublished = res.isPublished;
  updatedAt = res.updatedAt;
  createdAt = res.createdAt;
} catch (error) {
  return new Response(null, { status: 404 });
}
---

<Layout title={slug}>
  <main
    class="max-w-screen-md px-4 mb-24 object-center m-auto text-left select-none codex-editor pt-4 md:pt-8"
    set:html={content}
  />
</Layout>
